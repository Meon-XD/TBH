<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery App - Upload & Edit Foto</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gallery-item {
            transition: all 0.3s ease;
        }
        .gallery-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        .drop-zone {
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .drop-zone:hover {
            border-color: #3b82f6;
            background-color: #f8fafc;
        }
        .drop-zone.dragover {
            border-color: #3b82f6;
            background-color: #eff6ff;
        }
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            color: white;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        .toast.success {
            background-color: #10b981;
        }
        .toast.error {
            background-color: #ef4444;
        }
        .toast.info {
            background-color: #3b82f6;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        .image-preview {
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            margin: 0 auto;
            display: block;
        }
        .upload-progress {
            height: 4px;
            background-color: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress-bar {
            height: 100%;
            background-color: #3b82f6;
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-camera text-white text-lg"></i>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">Gallery App</h1>
                </div>
                <button onclick="showUploadModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2">
                    <i class="fas fa-plus"></i>
                    <span>Upload Foto</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Stats Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">Total Foto</p>
                        <h3 class="text-2xl font-bold text-gray-800" id="total-photos">0</h3>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-images text-blue-600 text-xl"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">Ukuran Total</p>
                        <h3 class="text-2xl font-bold text-gray-800" id="total-size">0 MB</h3>
                    </div>
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-database text-green-600 text-xl"></i>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm">Terakhir Diupload</p>
                        <h3 class="text-2xl font-bold text-gray-800" id="last-upload">-</h3>
                    </div>
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-clock text-purple-600 text-xl"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gallery Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="gallery-grid">
            <!-- Photos will be dynamically added here -->
            <div class="text-center py-12 text-gray-500 col-span-full" id="empty-state">
                <i class="fas fa-images text-4xl mb-4 text-gray-300"></i>
                <p class="text-lg">Belum ada foto yang diupload</p>
                <p class="text-sm mt-2">Klik tombol Upload Foto untuk memulai</p>
            </div>
        </div>
    </main>

    <!-- Upload Modal -->
    <div class="modal" id="upload-modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">Upload Foto Baru</h2>
                <button onclick="hideUploadModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="drop-zone mb-6" id="drop-zone" ondragover="handleDragOver(event)" ondrop="handleDrop(event)" onclick="document.getElementById('file-input').click()">
                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                <p class="text-gray-600 mb-2">Klik atau tarik file ke sini untuk upload</p>
                <p class="text-sm text-gray-500">Format yang didukung: JPG, PNG, GIF, WEBP (Max 10MB)</p>
            </div>
            
            <input type="file" id="file-input" accept="image/*" class="hidden" onchange="handleFileSelect(event)">
            
            <div class="mb-6 hidden" id="preview-container">
                <img id="image-preview" class="image-preview w-full mb-4">
                <div class="upload-progress hidden" id="upload-progress">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Judul Foto</label>
                        <input type="text" id="photo-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Masukkan judul foto">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                        <textarea id="photo-description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3" placeholder="Tambahkan deskripsi foto"></textarea>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button onclick="hideUploadModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium">
                    Batal
                </button>
                <button onclick="uploadPhoto()" id="upload-btn" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Upload
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="edit-modal">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-gray-800">Edit Foto</h2>
                <button onclick="hideEditModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <img id="edit-image-preview" class="image-preview w-full mb-6">
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Judul Foto</label>
                    <input type="text" id="edit-photo-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Deskripsi</label>
                    <textarea id="edit-photo-description" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3"></textarea>
                </div>
            </div>
            
            <div class="flex justify-between">
                <button onclick="deletePhoto()" class="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 flex items-center space-x-2">
                    <i class="fas fa-trash"></i>
                    <span>Hapus</span>
                </button>
                <div class="flex space-x-3">
                    <button onclick="hideEditModal()" class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium">
                        Batal
                    </button>
                    <button onclick="saveEdit()" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700">
                        Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <h2> Created By Radit - all Deserved &copy 2025</h2>
    </footer>

    <!-- Toast Container -->
    <div class="toast" id="toast"></div>

    <script>
        let photos = JSON.parse(localStorage.getItem('gallery_photos')) || [];
        let currentEditId = null;
        let currentFile = null;

        // Initialize the gallery
        function initGallery() {
            updateStats();
            renderGallery();
            setupEventListeners();
        }

        // Setup event listeners
        function setupEventListeners() {
            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                document.addEventListener(eventName, preventDefaults, false);
            });

            // Highlight drop zone when file is dragged over it
            ['dragenter', 'dragover'].forEach(eventName => {
                document.getElementById('drop-zone').addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                document.getElementById('drop-zone').addEventListener(eventName, unhighlight, false);
            });
        }

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        function highlight(e) {
            document.getElementById('drop-zone').classList.add('dragover');
        }

        function unhighlight(e) {
            document.getElementById('drop-zone').classList.remove('dragover');
        }

        // Update statistics
        function updateStats() {
            const totalPhotos = photos.length;
            const totalSize = photos.reduce((sum, photo) => sum + (photo.size || 0), 0) / (1024 * 1024);
            const lastUpload = photos.length > 0 ? new Date(photos[photos.length - 1].uploadDate).toLocaleDateString('id-ID') : '-';

            document.getElementById('total-photos').textContent = totalPhotos;
            document.getElementById('total-size').textContent = totalSize.toFixed(2) + ' MB';
            document.getElementById('last-upload').textContent = lastUpload;
        }

        // Render gallery items
        function renderGallery() {
            const galleryGrid = document.getElementById('gallery-grid');
            const emptyState = document.getElementById('empty-state');
            
            if (photos.length === 0) {
                emptyState.classList.remove('hidden');
                galleryGrid.innerHTML = '';
                galleryGrid.appendChild(emptyState);
                return;
            }
            
            emptyState.classList.add('hidden');
            
            galleryGrid.innerHTML = photos.map(photo => `
                <div class="gallery-item bg-white rounded-lg overflow-hidden shadow-sm border border-gray-100">
                    <div class="relative group">
                        <img src="${photo.url}" alt="${photo.title || 'Gallery photo'}" class="w-full h-48 object-cover">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 flex items-center justify-center opacity-0 group-hover:opacity-100">
                            <div class="flex space-x-3">
                                <button onclick="editPhoto('${photo.id}')" class="w-10 h-10 bg-white rounded-full flex items-center justify-center hover:bg-blue-50 text-blue-600">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="viewPhoto('${photo.id}')" class="w-10 h-10 bg-white rounded-full flex items-center justify-center hover:bg-green-50 text-green-600">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="downloadPhoto('${photo.id}')" class="w-10 h-10 bg-white rounded-full flex items-center justify-center hover:bg-purple-50 text-purple-600">
                                    <i class="fas fa-download"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800 truncate">${photo.title || 'Untitled'}</h3>
                        <p class="text-sm text-gray-600 truncate">${photo.description || 'No description'}</p>
                        <div class="flex items-center justify-between mt-3 text-xs text-gray-500">
                            <span>${new Date(photo.uploadDate).toLocaleDateString('id-ID')}</span>
                            <span>${(photo.size / (1024 * 1024)).toFixed(2)} MB</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Show upload modal
        function showUploadModal() {
            document.getElementById('upload-modal').classList.add('show');
            resetUploadForm();
        }

        // Hide upload modal
        function hideUploadModal() {
            document.getElementById('upload-modal').classList.remove('show');
        }

        // Show edit modal
        function showEditModal() {
            document.getElementById('edit-modal').classList.add('show');
        }

        // Hide edit modal
        function hideEditModal() {
            document.getElementById('edit-modal').classList.remove('show');
        }

        // Handle drag over event
        function handleDragOver(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('drop-zone').classList.add('dragover');
        }

        // Handle drop event
        function handleDrop(event) {
            event.preventDefault();
            event.stopPropagation();
            document.getElementById('drop-zone').classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        // Handle file select
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                handleFile(file);
            }
        }

        // Handle file processing
        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                showToast('Hanya file gambar yang diperbolehkan', 'error');
                return;
            }
            
            if (file.size > 10 * 1024 * 1024) {
                showToast('Ukuran file maksimal 10MB', 'error');
                return;
            }
            
            currentFile = file;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('preview-container').classList.remove('hidden');
                document.getElementById('image-preview').src = e.target.result;
                document.getElementById('upload-btn').disabled = false;
            };
            reader.readAsDataURL(file);
        }

        // Upload photo with progress simulation
        function uploadPhoto() {
            if (!currentFile) {
                showToast('Pilih file gambar terlebih dahulu', 'error');
                return;
            }
            
            const title = document.getElementById('photo-title').value;
            const description = document.getElementById('photo-description').value;
            
            // Show progress bar
            document.getElementById('upload-progress').classList.remove('hidden');
            document.getElementById('upload-btn').disabled = true;
            
            // Simulate upload progress
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += 10;
                document.getElementById('progress-bar').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    completeUpload(title, description);
                }
            }, 50);
        }

        // Complete the upload process
        function completeUpload(title, description) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const newPhoto = {
                    id: Date.now().toString(),
                    url: e.target.result,
                    title: title,
                    description: description,
                    size: currentFile.size,
                    uploadDate: new Date().toISOString(),
                    filename: currentFile.name,
                    type: currentFile.type
                };
                
                photos.push(newPhoto);
                saveToLocalStorage();
                updateStats();
                renderGallery();
                
                hideUploadModal();
                showToast('Foto berhasil diupload!', 'success');
                
                // Reset for next upload
                currentFile = null;
            };
            
            reader.readAsDataURL(currentFile);
        }

        // Edit photo
        function editPhoto(id) {
            const photo = photos.find(p => p.id === id);
            if (!photo) return;
            
            currentEditId = id;
            document.getElementById('edit-image-preview').src = photo.url;
            document.getElementById('edit-photo-title').value = photo.title || '';
            document.getElementById('edit-photo-description').value = photo.description || '';
            
            showEditModal();
        }

        // Save edit
        function saveEdit() {
            const title = document.getElementById('edit-photo-title').value;
            const description = document.getElementById('edit-photo-description').value;
            
            const photoIndex = photos.findIndex(p => p.id === currentEditId);
            if (photoIndex !== -1) {
                photos[photoIndex].title = title;
                photos[photoIndex].description = description;
                
                saveToLocalStorage();
                renderGallery();
                hideEditModal();
                showToast('Perubahan berhasil disimpan!', 'success');
            }
        }

        // Delete photo
        function deletePhoto() {
            if (confirm('Apakah Anda yakin ingin menghapus foto ini?')) {
                photos = photos.filter(p => p.id !== currentEditId);
                saveToLocalStorage();
                updateStats();
                renderGallery();
                hideEditModal();
                showToast('Foto berhasil dihapus!', 'success');
            }
        }

        // View photo (full screen)
        function viewPhoto(id) {
            const photo = photos.find(p => p.id === id);
            if (photo) {
                window.open(photo.url, '_blank');
            }
        }

        // Download photo
        function downloadPhoto(id) {
            const photo = photos.find(p => p.id === id);
            if (photo) {
                const link = document.createElement('a');
                link.href = photo.url;
                link.download = photo.title || 'photo';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // Reset upload form
        function resetUploadForm() {
            document.getElementById('file-input').value = '';
            document.getElementById('photo-title').value = '';
            document.getElementById('photo-description').value = '';
            document.getElementById('preview-container').classList.add('hidden');
            document.getElementById('upload-progress').classList.add('hidden');
            document.getElementById('progress-bar').style.width = '0%';
            document.getElementById('upload-btn').disabled = true;
            currentFile = null;
        }

        // Save to localStorage
        function saveToLocalStorage() {
            localStorage.setItem('gallery_photos', JSON.stringify(photos));
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initGallery);
    </script>
</body>
</html>

